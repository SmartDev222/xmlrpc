# This file is a template, and might need editing before it works on your project.
# Official docker image.
image: microsoft/dotnet:2.1-sdk-alpine

environment:
  project_name: Kveer.XmlRPC
  configuration: Release

build-master:
  stage: build
  script:
    - cd "${project_name}"
    - dotnet restore "${project_name}.csproj"
    - dotnet build -c "${configuration}" "${project_name}.csproj"
    - dotnet pack -c "${configuration}" --include-symbols "${project_name}.csproj"
    - dotnet nuget push "${project_name}"/bin/"${configuration}"/*.nupkg $nuget_key -s nuget.org
    - dotnet nuget push "${project_name}"/bin/"${configuration}"/*.symbols.nupkg $nuget_key 
  only:
    - master
